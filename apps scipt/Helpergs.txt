/**
 * Mencari nomor baris berdasarkan ID Unik
 */
function findRowById(sheet, id) {
  const colID = getColumnIndex(sheet, CONFIG.COL_HEADERS.ID_UNIK);
  if (!colID) return null;
  
  const data = sheet.getRange(1, colID, sheet.getLastRow(), 1).getValues();
  for (let i = 0; i < data.length; i++) {
    // Menggunakan == untuk toleransi perbandingan tipe data string/number
    if (data[i][0] == id) {
      return i + 1;
    }
  }
  return null;
}

/**
 * Mencari nomor urut kolom berdasarkan nama Header di baris pertama
 */
function getColumnIndex(sheet, headerName) {
  const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
  for (let i = 0; i < headers.length; i++) {
    if (headers[i].toString().trim() === headerName) {
      return i + 1;
    }
  }
  return null;
}